<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title> MaHua 在线markdown编辑器</title>
    <meta name="keywords" content="online markdown editor,markdown编辑器,在线编辑markdown" />
    <meta name="description" content="MaHua是一个在线编辑markdown的工具" />
    <meta name="COPYRIGHT" content="版权所有2012,http://MaHua.jser.me/">
    <link href="mahua.css?v=3" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="favicon.png" type="image/vnd.microsoft.icon" />
</head>
<body>




    <div class="mahua-container">
	
	<div id="inputBar" style="display:none;">URL:<input type="text" id="url" style="width:450px;"/>
			<select  style="width:80px;" id="selector" name="selector" >
				<option value="body">body</option>
			</select>
			<input type="checkbox" name="istable" id="istable">表格
			
			<input type="button" id="btnLoad" value="Load" />

			File Path:<input type="text" id="filename" style="width:450px;"/>

			<input type="button" id="btnSave" value="Save" />

			<span id="msg"></span>

	</div>
	
        <div id="mahua-docname" class="mahua-docanme" style="display:none;"></div>
        <ul class="mahua-topbar" id="mahua-topbar">
			<li class="mahua-vision" id="mahua-vision"></li>
			<!--
            <li class="mahua-github" id="mahua-github"><a href="https://github.com/jserme/mahua" target="_blank"><img src="./github.png" /></a></li>
            -->
			<li class="mahua-config" id="mahua-config"></li>
            <li class="mahua-session" id="mahua-session"></li>
        </ul>
        <div class="mahua-toolbar" style="display:none" id="mahua-toolbar">
            <table cellspacing="0">
                <tr>
                    <td> 
                        <label for="mahua-changeSession">选择文档</label>
                    </td>
                    <td>
                        <select id="mahua-changeSession" name=""> </select> 
                        <a href="javascript:;" id="mahua-removeSession">删除</a>
                    </td>
                </tr>
                <tr>
                    <td> 
                        <label for="mahua-editorThemes">编辑器主题</label>
                    </td>
                    <td>
                        <select id="mahua-editorThemes" name=""> </select>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="mahua-previewThemes">预览主题</label>
                    </td>
                    <td>
                        <select id="mahua-previewThemes" name=""></select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <table cellspacing="0">
                            <tr>
                                <td>
                                    <label for="mahua-keyboard">VIM快捷键</label>
                                </td>
                                <td>
                                    <input id="mahua-keyboard" type="checkbox" checked class="checkbox" value="" name="" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="mahua-linenum">行号<label>
                                </td>
                                <td>
                                    <input id="mahua-linenum" type="checkbox" checked class="checkbox" value="" name="" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="mahua-attachInfo">附加MaHua信息<label>
                                </td>
                                <td>
                                    <input id="mahua-attachInfo" type="checkbox" checked class="checkbox" value="" name="" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="mahua-syncRoll">自动滚动<label>
                                </td>
                                <td>
                                    <input id="mahua-syncRoll" type="checkbox" class="checkbox" value="" name="" />
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input id="mahua-toggleMode" type="button" class="button" value="自定义CSS" name="" />
                        <input id="mahua-importSource" type="button" class="button" value="导入" name="" />
                        <input id="mahua-exportHTML" type="button" class="button" value="导出" name="" />
                        <input id="mahua-closeConfig" type="button" class="button" value="关闭设置" name="" />
                    </td>
                </tr>
            </table>
        </div>
        <div class="mahua-spliter" id="mahua-spliter"></div>
        <div class="mahua-left">
			
            <div id="mahua-editor" style="height:100%;width:50%;"></div>
        </div>
        <div class="mahua-right" id="mahua-result"> </div>
    </div>
    <script type="text/javascript" src="ace/ace.js"></script>
    <script type="text/javascript" src="ace/keybinding-vim.js"></script>
    <script type="text/javascript" src="all.js?v=5"></script>
    <script type="text/javascript">
        (function() {
       


	     $('#btnLoad').click(function(){
		 
		      var url=$('#url').val();
			  var selector=$('#selector').val()
			  var istable=$('#istable').attr('checked')?1:0;
			  $.post('info.php',{url:url,selector:selector,istable:istable,action:'load'},function(md){
			  
			    var data= eval('('+md+')');
			    editor.setValue(data.md);

				$('#filename').val(data.title);

				var html="";
				var flag=false;
				for(var op in data.selector){
					if(data.selector[op]==selector){
						flag=true;
					}
					html+='<option value="'+data.selector[op]+'" >'+	data.selector[op] +'</option>';
				}

					
                if(!flag){
					$('#selector').html(html);
				}
			  
			  }) 
		 
		 })


		   $('#btnSave').click(function(){
		 
		      var filename=$('#filename').val();
			  var md=editor.getValue();
			  $.post('info.php',{filename:filename+".md",md:md,action:'save'},function(result){
			  
			       if(result==1){
					  $('#msg').html('<font color="green">保存成功！</font>');
				   } else {
					   $('#msg').html('<font color="red">保存失败！</font>');
				   }
			  
			  }) 
		 
		 })//end click;


		 $('#mahua-vision').click(function(){
		 
			$('#inputBar').toggle();

		 })//end click


        })();
    </script>
</body>
</html>
